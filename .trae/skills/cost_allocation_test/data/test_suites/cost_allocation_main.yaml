name: "Cost Allocation Core Logic"
description: "Verify core business questions for IT cost allocation (Q1-Q5)"
data_source_type: "postgresql"
agent_skill: "cost_allocation"

test_cases:
  - id: "q1_services"
    name: "Question 1: IT Services List"
    query: "What services do IT cost include in FY24? And what is the allocation key?"
    expectations:
      result_contains_any: 
        - "7092 GS IT_SW"
        - "GS IT"
      sql_contains: 
        - "SELECT"
    config:
      recursion_limit: 50

  - id: "q2_hr_budget"
    name: "Question 2: HR Budget Check"
    query: "What was the HR Cost in FY26 Budget1?"
    expectations:
      result_value_approx: 
        value: 12054383
        tolerance: 1000  # Allow small float diff
    config:
      recursion_limit: 50

  - id: "q3_it_alloc"
    name: "Question 3: IT Allocation to CT"
    query: "What was the actual IT cost allocated to CT in FY25?"
    expectations:
      result_value_approx:
        value: -7847136
        tolerance: 10000 # Allow some variance
    config:
      recursion_limit: 50

  - id: "q4_procurement"
    name: "Question 4: Procurement YoY Change"
    query: "How does Procurement Cost change from FY25 Actual to FY26 Budget1?"
    expectations:
      # Expecting a comparison result, maybe text or table containing specific numbers
      result_contains_all:
        - "1929340"  # FY25 Base
        - "2025807"  # FY26 Target
    config:
      recursion_limit: 50

  - id: "q5_hr_alloc_change"
    name: "Question 5: HR Allocation Change"
    query: "How is the change of HR allocation to 413001 between FY26 Budget1 and FY25 Actual?"
    expectations:
      # Complex result, checking for key figures
      result_contains_any:
        - "241509"   # FY25 Alloc part
        - "216875"   # FY26 Alloc part
        - "24634"    # Diff
    config:
      recursion_limit: 50
